{
    "{4D65E62C-44B8-4B6A-96A7-6196671B71E2}": {
        "source": "const poling = require( '/src/poling' )\r\n\r\nmodule.exports = poling",
        "path": "{browser}/index.js",
        "mapping": {
            "/src/poling": "{FF248E44-F4BB-45F6-84A5-5BACE8597E1C}"
        }
    },
    "{FF248E44-F4BB-45F6-84A5-5BACE8597E1C}": {
        "source": "\r\nconst { isRegExp, isNumber } = require( 'typecheck' )\r\n\r\nfunction poling ( callback, options ) {\r\n\r\n    function wait ( browser ) {\r\n        if ( isNumber( browser ) ) {\r\n            let time = Math.random() * browser\r\n            const finish = new Date().getTime() + browser / 2 + time\r\n            let count = 0\r\n            let carriageReturn = '\\u001B[1G'\r\n            while ( Date.now() < finish ) {\r\n                console.print( carriageReturn + 'waiting ' + display[ count++ % 4 ] )\r\n                WScript.Sleep( 50 )\r\n            }\r\n        } else {\r\n            while ( browser.Busy || browser.readystate != 4 ) {\r\n                WScript.Sleep(100)\r\n            }\r\n        }\r\n    }\r\n\r\n    const app = require( 'InternetExplorer.Application' )\r\n    app.Visible = !options.invisible\r\n    app.Navigate( options.home || 'about:blank' )\r\n\r\n    wait( app )\r\n\r\n    const events = new Map()\r\n    const event = {\r\n        on ( target, fn ) {\r\n            if ( events.has( target ) ) events.get( target ).push( fn )\r\n            else events.set( target, [ fn ] )\r\n        },\r\n        emit ( url, ...params ) {\r\n            events.forEach( ( callbacks, evaluation ) => {\r\n                if ( ( isRegExp( evaluation ) && evaluation.test( url ) ) || String( evaluation ) === url ) callbacks.forEach( fn => fn( url, ...params ) )\r\n            } )\r\n        }\r\n    }\r\n\r\n    let result = {}\r\n\r\n    try {\r\n        callback( app, event, result, wait )\r\n\r\n        let state = ''\r\n        let count = 0\r\n        let carriageReturn = '\\u001B[1G'\r\n\r\n        while ( true ) {\r\n            let display = [ '|', '/', '-', '\\\\' ]\r\n            wait( app )\r\n            let url = app.document.location.href\r\n            if ( state === url ) {\r\n                console.print( carriageReturn + 'poling ' + display[ count++ % 4 ] )\r\n                WScript.Sleep( 50 )\r\n                continue\r\n            }\r\n            wait( app )\r\n            event.emit( url )\r\n            state = url\r\n        }\r\n    } catch ( error ) {\r\n        console.log( '\\n' )\r\n        if ( app != null ) app.Visible = true\r\n        if ( options.exception ) options.exception( error, result, app )\r\n        else throw error\r\n    }\r\n}\r\n\r\nexports.poling = poling\r\n",
        "path": "{browser}/src/poling.js",
        "mapping": {}
    }
}